<!DOCTYPE html>
<html lang="zh-cn">
<head>
	<meta charset="UTF-8">
	<title>我的塑料网-注册</title>
	<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	<link href="__CSS__/wx/normalize.css" rel="stylesheet">
	<link href="__CSS__/wx/layer.css" rel="stylesheet">
	<link href="__CSS__/wx/app.css" rel="stylesheet">
	<script src="__JS__/wx/jquery-2.2.3.min.js" type="text/javascript"></script>
	<script src="__JS__/wx/layer.js" type="text/javascript"></script>
	<script type="text/javascript">
		$(function () {

			function sendMsg() {
				var times=60;
				var username=$("#username").val();
				var password=$("#password").val();
				$.ajax({
					type: 'POST',
					url: "/touch/findpwd/sendmsg",
					data: {'mobile':username,'password':password},
					dataType:'json',
					success:function(res){
						if(res.err!=0){
							layer.open({
								content: res.msg,
								time:2
							});
						}else{
							var countStart=setInterval(function(){
								$(".validCode").text(times--+'秒后重发');
								$(".validCode").attr("disabled",true);
								if(times<0){
									clearInterval(countStart);
									$(".validCode").text("获取验证码");
									$(".validCode").attr("disabled",false);
								}
							},1000);
						}
					},
					error:function () {

					}
				});
			}

			$(".validCode").on("click",function () {
				if($("#username").val()){
					sendMsg();
				}else{
					layer.open({
						content: "请先输入手机号码",
						time:2
					});
				}
			});

			$(".registerBtn").on("click",function () {
				var username=$("#username").val();
				var password=$("#password").val();
				var vcode=$("#vcode").val();
				$.ajax({
					type:"post",
					url:"/touch/register/register",
					data:{
						username:username,
						password:password,
						vcode:vcode
					},
					dataType:'json',
					beforeSend:function () {
						layer.open({
							content: '加载中…'
						});
					},
					success:function (res) {
						layer.closeAll();
						if(res.err==0){
							layer.open({
								content: res.msg,
								time:2
							});
						}else{
							layer.open({
								content: res.msg,
								time:2
							});
						}
					},
					error:function (res) {
						layer.open({
							content: '系统错误',
							time:2
						});
					}
				});
			});
		})
	</script>
</head>
<body>
<div class="registerWrap">
	<div class="registerBox">
		<img src="__IMG__/wx/username.jpg">
		<input id="username" class="registerInput" maxlength="11" type="tel" placeholder="请输入手机号码">
	</div>
	<div class="registerBox">
		<img src="__IMG__/wx/pwd.jpg">
		<input id="password" class="registerInput" maxlength="20" type="password" placeholder="请输入密码">
	</div>
	<div class="registerBox">
		<input id="vcode" class="registerInput" maxlength="6" type="tel" placeholder="请输入6位验证码">
		<button class="validCode">获取验证码</button>
	</div>
	<div class="registerBtn">注册</div>
</div>
</body>
</html>